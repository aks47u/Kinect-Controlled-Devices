Kinect-Controlled-Devices
=========================

<h5>Demonstrate IT competition to design reusable course content for NUI Maynooth Open Days</h5>

<div>
    <div>
    </div>
    <p>
        Demonstrate IT 2014 Project Report
    </p>
    <p>
        for
    </p>
    <p>
        Kinect Controlled Devices
    </p>
    <p>
        Version 3.0
    </p>
    <p>
        Team Demon
    </p>
    <table border="0" cellpadding="0" cellspacing="0">
        <tbody>
            <tr>
                <td width="319">
                    <p align="center">
                        <img src="file:///c:\Temp\msohtmlclip1\01\clip_image002.gif" height="140" width="298"/>
                    </p>
                </td>
                <td width="319">
                    <p align="center">
                        <img
                            src="http://www.journaldugeek.com/files/2013/07/mindstorms-lego-mindstorms-nxt-2-0-8547-4.jpg"
                            alt="http://www.journaldugeek.com/files/2013/07/mindstorms-lego-mindstorms-nxt-2-0-8547-4.jpg"
                            height="228"
                            width="298"
                        />
                    </p>
                </td>
            </tr>
        </tbody>
    </table>
    <strong>
        <br clear="all"/>
    </strong>
    <p>
        <a name="_Toc416530762"></a>
        <a name="_Toc232994784"></a>
        <a name="_Toc386487642">Table of Contents</a>
    </p>
    <p>
        Table of Contents............................................................................................................. 1
    </p>
    <p>
        Group Members................................................................................................................ 2
    </p>
    <p>
        Project Timeline................................................................................................................ 2
    </p>
    <p>
        1. Project Summary............................................................................................................ 3
    </p>
    <p>
        1.1. Content Summary................................................................................................... 3
    </p>
    <p>
        1.2. Lessons Learned..................................................................................................... 4
    </p>
    <p>
        2. Reusability..................................................................................................................... 4
    </p>
    <p>
        2.1. Materials Required.................................................................................................. 4
    </p>
    <p>
        2.2. Setup....................................................................................................................... 5
    </p>
    <p>
        3. How it works................................................................................................................. 6
    </p>
    <p>
        4. Future directions............................................................................................................ 7
    </p>
    <p>
        5. Appendix........................................................................................................................ 8
    </p>
    <p>
        5.1. Lego Mindstorms.................................................................................................... 8
    </p>
    <p>
        5.2. MindSqualls .Net Library........................................................................................ 8
    </p>
    <p>
        5.3. Kinect SDK............................................................................................................ 8
    </p>
    <p>
        5.4. Foundation of our project....................................................................................... 8
    </p>
    <p>
        5.5. C# Programming.................................................................................................... 8
    </p>
    <p>
        5.6. Others:.................................................................................................................... 8
    </p>
    <strong>
        <br clear="all"/>
    </strong>
    <p>
        <a name="_Toc232994785"></a>
        <a name="_Toc386487643"></a>
        <a name="_Toc232994786">Group Members</a>
    </p>
    <table border="1" cellpadding="0" cellspacing="0" width="637">
        <tbody>
            <tr>
                <td valign="top" width="140">
                    <p>
                        <strong>Name</strong>
                    </p>
                </td>
                <td valign="top" width="180">
                    <p>
                        <strong>Role</strong>
                    </p>
                </td>
                <td valign="top" width="318">
                    <p>
                        <strong>Responsibilities</strong>
                    </p>
                </td>
            </tr>
            <tr>
                <td valign="top" width="140">
                    <p>
                        Conor Fitzpatrick
                    </p>
                </td>
                <td valign="top" width="180">
                    <p>
                        Software Developer, Concept Manager &amp; Project Presenter
                    </p>
                </td>
                <td valign="top" width="318">
                    <p>
                        Oversee project activities, supervise solution integration into existing infrastructure during updates. C# &amp; XML development.
                        Presenting Project at open day.
                    </p>
                </td>
            </tr>
            <tr>
                <td valign="top" width="140">
                    <p>
                        Ollie Noonan
                    </p>
                </td>
                <td valign="top" width="180">
                    <p>
                        Interface Design, Gesture Configuration &amp; Software Developer
                    </p>
                </td>
                <td valign="top" width="318">
                    <p>
                        Supervise hardware implementation. Design and implementation of UI. Power regulation control. C# development
                    </p>
                </td>
            </tr>
        </tbody>
    </table>
    <p>
        <a name="_Toc386487644">Project </a>
        Timeline
    </p>
    <table border="1" cellpadding="0" cellspacing="0" width="637">
        <tbody>
            <tr>
                <td valign="top" width="140">
                    <p>
                        <strong>Name</strong>
                    </p>
                </td>
                <td valign="top" width="104">
                    <p>
                        <strong>Date</strong>
                    </p>
                </td>
                <td valign="top" width="312">
                    <p>
                        <strong>Reason For Changes</strong>
                    </p>
                </td>
                <td valign="top" width="82">
                    <p>
                        <strong>Version</strong>
                    </p>
                </td>
            </tr>
            <tr>
                <td valign="top" width="140">
                    <p>
                        Conor Fitzpatrick
                    </p>
                    <p>
                        Ollie Noonan
                    </p>
                </td>
                <td valign="top" width="104">
                    <p>
                        10/03/2014
                    </p>
                </td>
                <td valign="top" width="312">
                    <p>
                        Initial Project plan: Robot design and development software chosen.
                    </p>
                </td>
                <td valign="top" width="82">
                    <p>
                        0.1
                    </p>
                </td>
            </tr>
            <tr>
                <td valign="top" width="140">
                    <p>
                        Ollie Noonan
                    </p>
                    <p>
                        Conor Fitzpatrick
                    </p>
                </td>
                <td valign="top" width="104">
                    <p>
                        16/03/2014
                    </p>
                </td>
                <td valign="top" width="312">
                    <p>
                        Lego Mindstorm robot constructed.
                    </p>
                    <p>
                        Test code for robot control build in Java, Research on Kinect programming.
                    </p>
                </td>
                <td valign="top" width="82">
                    <p>
                        0.2
                    </p>
                </td>
            </tr>
            <tr>
                <td valign="top" width="140">
                    <p>
                        Conor Fitzpatrick
                    </p>
                    <p>
                        Ollie Noonan
                    </p>
                </td>
                <td valign="top" width="104">
                    <p>
                        29/03/2014
                    </p>
                </td>
                <td valign="top" width="312">
                    <p>
                        Initial Windows Application created for controlling the robot. Kinect development delayed as research continues.
                    </p>
                </td>
                <td valign="top" width="82">
                    <p>
                        1.0
                    </p>
                </td>
            </tr>
            <tr>
                <td valign="top" width="140">
                    <p>
                        Ollie Noonan
                    </p>
                    <p>
                        Conor Fitzpatrick
                    </p>
                </td>
                <td valign="top" width="104">
                    <p>
                        31/03/2014
                    </p>
                </td>
                <td valign="top" width="312">
                    <p>
                        Kinect now working as basic controller but with poorly.
                    </p>
                </td>
                <td valign="top" width="82">
                    <p>
                        1.5
                    </p>
                </td>
            </tr>
            <tr>
                <td valign="top" width="140">
                    <p>
                        Conor Fitzpatrick
                    </p>
                    <p>
                        Ollie Noonan
                    </p>
                </td>
                <td valign="top" width="104">
                    <p>
                        02/04/2014
                    </p>
                </td>
                <td valign="top" width="312">
                    <p>
                        Complete rewrite of software, Dropped use of java on robot. Device now completely controlled by Kinect over Bluetooth by keyboard
                        simulation, Basic motion control. No code needed on robot
                    </p>
                </td>
                <td valign="top" width="82">
                    <p>
                        2.0
                    </p>
                </td>
            </tr>
            <tr>
                <td valign="top" width="140">
                    <p>
                        Ollie Noonan
                    </p>
                </td>
                <td valign="top" width="104">
                    <p>
                        04/04/2014
                    </p>
                </td>
                <td valign="top" width="312">
                    <p>
                        More advanced control through extra gesture recognition
                    </p>
                </td>
                <td valign="top" width="82">
                    <p>
                        2.1
                    </p>
                </td>
            </tr>
            <tr>
                <td valign="top" width="140">
                    <p>
                        Conor Fitzpatrick
                    </p>
                </td>
                <td valign="top" width="104">
                    <p>
                        10/04/2014
                    </p>
                </td>
                <td valign="top" width="312">
                    <p>
                        Simplified Gestures based on feedback from demonstration to Lecturers
                    </p>
                </td>
                <td valign="top" width="82">
                    <p>
                        2.2
                    </p>
                </td>
            </tr>
            <tr>
                <td valign="top" width="140">
                    <p>
                        Ollie Noonan
                    </p>
                    <p>
                        Conor Fitzpatrick
                    </p>
                </td>
                <td valign="top" width="104">
                    <p>
                        11/04/2014
                    </p>
                </td>
                <td valign="top" width="312">
                    <p>
                        Final Version, Removed redundant code
                    </p>
                </td>
                <td valign="top" width="82">
                    <p>
                        3.0
                    </p>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<br clear="all"/>
<h1>
    <a name="_Toc386487645"></a>
    <a name="_Toc232994787">1. Project Summary</a>
</h1>
<p>
    To boost interest in computer science at NUI Maynooth open days we decided our project should impress visitors and let them see the potential open to them
    if they were to pursue a degree in computer science.
</p>
<p>
    As the expected age group of the open days are 2<sup>nd</sup> level leaving certificate students we felt that using existing technology that they would be
    familiar with combined with robotics may provide enough of a wow factor to increase interest in computer science.
</p>
<h2>
    <a name="_Toc386487646"></a>
    <a name="_Toc232994788">1.1. Content Summary</a>
</h2>
<p>
    <strong><u>Scope</u></strong>
</p>
<p>
    <strong><u> </u></strong>
</p>
<p>
    This project demonstrates simulated keyboard input using the Kinect and a Lego Mindstorms Robot.
</p>
<p>
    By utilizing the Microsoft Kinect’s motion tracking functionality we were able to set certain “key” gestures that when recognised by the master program
    would simulate a key-press.
</p>
<p>
    To demonstrate this key-press simulation we mapped our keypresses to Lego Mindstorms motor control commands.
</p>
<p>
    When a motion executed and recognised, a keypress in simulated and a motor command is sent to the robot which then starts to move (or stop depending on the
    command sent).
</p>
<p>
    <strong><u>Schedule</u></strong>
</p>
<p>
    This engagement began on April 10, 2014 and finished on April 28, 2014 with the submission of this report. The majority of this time was spent on research
    with approximately 13 hours of development.
</p>
<p>
    <strong><u>Costs</u></strong>
</p>
<p>
    All Hardware was provided by the Computer Science department.
</p>
<p>
    All additional costs have been development, software and programming time.
</p>
<p>
    <strong><u>Risks</u></strong>
</p>
<p>
    <strong><u> </u></strong>
</p>
<table border="1" cellpadding="0" cellspacing="0">
    <tbody>
        <tr>
            <td valign="top" width="196">
                <p>
                    <strong><em>Risk</em></strong>
                </p>
            </td>
            <td valign="top" width="76">
                <p>
                    <strong><em>Impact</em></strong>
                </p>
            </td>
            <td valign="top" width="95">
                <p>
                    <strong><em>Probability</em></strong>
                </p>
            </td>
            <td valign="top" width="272">
                <p>
                    <strong><em>Mitigation</em></strong>
                </p>
            </td>
        </tr>
        <tr>
            <td valign="top" width="196">
                <p>
                    The Project would require more time that we would have available as neither team member has experience with Kinect development or C#
                </p>
            </td>
            <td valign="top" width="76">
                <p>
                    Moderate
                </p>
            </td>
            <td valign="top" width="95">
                <p>
                    Moderate
                </p>
            </td>
            <td valign="top" width="272">
                <p>
                    Continuous communication between all team members and scheduled meetings allowed for efficient utilization of time available.
                </p>
            </td>
        </tr>
        <tr>
            <td valign="top" width="196">
                <p>
                    Our project may appear too similar to other projects being showcased by other students
                </p>
            </td>
            <td valign="top" width="76">
                <p>
                    High
                </p>
            </td>
            <td valign="top" width="95">
                <p>
                    Moderate
                </p>
            </td>
            <td valign="top" width="272">
                <p>
                    As our project requires the user to use their entire body to perform gesture control we hope that this extra effort combined with mild
                    embarrassment of the user on front of their friends may work to our advantage
                </p>
            </td>
        </tr>
    </tbody>
</table>
<p>
    <strong><u>Communications Strategy</u></strong>
</p>
<p>
    The team utilized several communication methods to collaborate with each other; including email, instant web meeting technology &amp; face to face
    meetings. Online storage through Dropbox allowed for basic version control. Feedback provided by Lectures during presentation of the project to them was
    noted with high regard for improvements and changes.
</p>
<h2>
    <a name="_Toc386487647"></a>
    <a name="_Toc232994789">1.2. Lessons Learned</a>
</h2>
<p>
    Our primary lesson learned was to the consideration as to what initially enticed us to computer science. After careful consideration, we determined that
    the WOW factor was a strong motivator and as such we should attempt to wow potential computer science students by showing them how technology that was
    already impressive to them could be put under their control.
</p>
<p>
    Another important lesson was to aim for small milestones and once they were complete to then add additional features. This allowed us to ensure a completed
    core project within the time available before any attempts were made to enhance features.
</p>
<h1>
    <a name="_Toc386487648">2. Reusability</a>
</h1>
<h2>
    <a name="_Toc386487649">2.1. Materials Required.</a>
</h2>
<p>
    Below is a list of the materials required to both run and further develop this project. A copy of Mindsqualls is included in the Zip file for this project.
    Links to the software are provided in appendix #. Compatibility with future releases of any hardware or software listed in not guaranteed.
</p>
<p>
    .
</p>
<p>
    Hardware:
</p>
<ul>
    <li>
        Microsoft Kinect Device
    </li>
    <li>
        Lego MindStorms v2.0 Robot
    </li>
</ul>
<p>
    · Bluetooth dongle or Bluetooth enabled computer
</p>
<p>
    · Admin Access on a Lab machine running Windows 7 or later.
</p>
<p>
    Software:
</p>
<ul>
    <li>
        .Net v4.5.1 or higher.
    </li>
    <li>
        Kinect SDK v1.8
    </li>
    <li>
        Mindsqualls .Net Library v2.2
    </li>
    <li>
        Windows Visual Studio 2010
    </li>
</ul>
<h2>
    <a name="_Toc386487650">2.2. Setup</a>
</h2>
<p>
    The following guide should allow you to showcase the project.
</p>
<p>
    It is assumed that a CS lab PC is being used and Microsoft Visual Studio 2010 is already installed and configured for general use.
</p>
<table border="0" cellpadding="0" cellspacing="0" width="640">
    <tbody>
        <tr>
            <td valign="top" width="640">
                <p>
                    <strong>Steps:</strong>
                </p>
            </td>
        </tr>
        <tr>
            <td valign="top" width="640">
                <p>
                    1. Assemble a Lego Mindstorms Robot
                </p>
            </td>
        </tr>
        <tr>
            <td valign="top" width="640">
                <p>
                    2. Log into lab machine using admin password
                </p>
            </td>
        </tr>
        <tr>
            <td valign="top" width="640">
                <p>
                    3. Insert Bluetooth dongle (Installation may be required)
                </p>
            </td>
        </tr>
        <tr>
            <td valign="top" width="640">
                <p>
                    4. Download and Install Kinect SDK
                </p>
            </td>
        </tr>
        <tr>
            <td valign="top" width="640">
                <p>
                    5. Plug in Kinect to power supply and connect USB to lab machine
                </p>
            </td>
        </tr>
        <tr>
            <td valign="top" width="640">
                <p>
                    6. Launch Visual Studio 2010 and open <em>KinectWindowsForm.cspr</em>
                </p>
            </td>
        </tr>
        <tr>
            <td valign="top" width="640">
                <p>
                    7. Turn on robot and ensure Bluetooth is enabled in its settings
                </p>
            </td>
        </tr>
        <tr>
            <td valign="top" width="640">
                <p>
                    8. Put the robot on the floor
                </p>
            </td>
        </tr>
        <tr>
            <td valign="top" width="640">
                <p>
                    9. On the PC determine the COM port for the Robot.
                </p>
            </td>
        </tr>
        <tr>
            <td valign="top" width="640">
                <p>
                    10. Run the KinectWindowsForm.cspr file from Visual Studio 2010
                </p>
            </td>
        </tr>
        <tr>
            <td valign="top" width="640">
                <p>
                    11. Choose the required COM port in the Device dropdown list or enter it in the text field and click Connect.
                </p>
                <p>
                    * If the Kinect is correctly installed you should see it listed as Online in the status bar.
                </p>
                <p>
                    * The Robot should also show as connected.
                </p>
            </td>
        </tr>
        <tr>
            <td valign="top" width="640">
                <p>
                    12. Stand on front of the Kinect sensor
                </p>
            </td>
        </tr>
        <tr>
            <td valign="top" width="640">
                <p>
                    13. Flap arms about like an idiot
                </p>
            </td>
        </tr>
        <tr>
            <td valign="top" width="640">
                <p>
                    14. Success!
                </p>
            </td>
        </tr>
    </tbody>
</table>
<p>
    <img src="file:///c:\Temp\msohtmlclip1\01\clip_image006.jpg" height="370" width="624"/>
</p>
<h1>
    <a name="_Toc386487651">3. How it works</a>
</h1>
<p>
    At its basics, When the Kinect recognizes a gesture it compares it to the preconfigured gestures in the Gestures.XML file which contains the key the
    gesture is mapped to.
</p>
<p>
    A virtual Keypress is then sent to the KeyboardController object which handles how to react to the key press.
</p>
<p>
    <img src="file:///c:\Temp\msohtmlclip1\01\clip_image008.jpg" height="85" width="623"/>
</p>
<p>
    The xml file defines both the gesture and the key press to simulate. The <em>Description</em> value is the text to be displayed in the output debug window
    when the gesture is recognized. The <em>beginning </em>and<em> end positions</em> of the two joints of the Kinect skeleton determines when this gesture is
    auctioned. The <em>MaxExecutionTime</em> is the time in milliseconds that the gesture should be made to be recognized allowing us to ignore false
    positives.
</p>
<p>
The <em>MainForm.cs</em> file requires the declaration of an object that implements the <em>KinectControlledDevice</em> interface. In our code this is a    <em>KeyboardController</em> object.
</p>
<p>
    The method void SensorSkeletonFrameReady(AllFramesReadyEventArgs e) in the <em>MainForm</em> is called by the Kinect to assess any potential gestures. It
    is within this method that a call to PerformKeyCodeAction(VirtualKeyCode keycode) should be made.
</p>
<p>
    In our project we have key presses being used to drive the robot however as long as you implement the <em>KeyboardController</em> interface you can easily
    control any device or program that responds to key presses. For further proof of this run the software and open a blank notepad file to see the key presses
    getting typed out.
</p>
<h1>
    <a name="_Toc386487652">4. Future directions</a>
</h1>
<p>
From the beginning we worked with the intention of allowing other students to easily develop this project further. Implementing the    <em>KinectControlledDevice</em> interface should allow for some interesting projects. Without any knowledge of Kinect programming any future developer
    should be able to alter this project to control multiple external devices or control PC games etc.
</p>
<p>
    Through trial and error a student can reconfigure the gestures file to map new key presses to further extend the control. Any student feeling overwhelmed
    by the amount of files and code in this project should take heart that the PerformKeyCodeAction method is the core method to develop.
</p>
<p>
    Any students that are really feeling brave could consider advancing this project to track eye/head movements and control an electric wheel chair etc.
</p>
<h1>
    <a name="_Toc386487653">5. Appendix</a>
</h1>
<h2>
    <a name="_Toc386487654">5.1. Lego Mindstorms</a>
</h2>
<p>
    <a href="http://www.lego.com/en-us/mindstorms/?domainredir=mindstorms.lego.com">http://www.lego.com/en-us/mindstorms/?domainredir=mindstorms.lego.com</a>
</p>
<p>
    Contains guides for working with NXT.
</p>
<p>
    See <a href="http://cache.lego.com/bigdownloads/buildinginstructions/4589648.pdf">http://cache.lego.com/bigdownloads/buildinginstructions/4589648.pdf</a>
    for a step by step guide to constructing the robot we used.
</p>
<h2>
    <a name="_Toc386487655">5.2. MindSqualls .Net Library</a>
</h2>
<p>
    <a href="http://www.mindsqualls.net/">http://www.mindsqualls.net/</a>
</p>
<p>
    Also contains some very good sample code for controlling the Lego Mindstorm NXT through C# without needing to install any code on the NXT brick.
</p>
<h2>
    <a name="_Toc386487656">5.3. Kinect SDK</a>
</h2>
<p>
    <strong> </strong>
    <a href="http://www.microsoft.com/en-us/kinectforwindowsdev/start.aspx">http://www.microsoft.com/en-us/kinectforwindowsdev/start.aspx</a>
</p>
<p>
    Also some very good video guides on Kinect development. Don’t forget to check out the samples in the SDK once downloaded.
</p>
<h2>
    <a name="_Toc386487657">5.4. Foundation of our project</a>
</h2>
<p>
    <a href="http://code.msdn.microsoft.com/windowsdesktop/Simple-Gesture-Processing-097c5527">
        http://code.msdn.microsoft.com/windowsdesktop/Simple-Gesture-Processing-097c5527
    </a>
</p>
<p>
    <strong> </strong>
</p>
<p>
    Excellent sample project, used as foundation for this project.
</p>
<h2>
    <a name="_Toc386487658">5.5. C# Programming</a>
</h2>
<p>
    <a href="http://www.tutorialspoint.com/csharp/">http://www.tutorialspoint.com/csharp/</a>
</p>
<p>
    Useful for getting to grips with C# programming.
</p>
<h2>
    <a name="_Toc386487659">5.6. Others:</a>
</h2>
<p>
    <a href="http://www.google.com">www.google.com</a>
</p>
<p>
    <a href="http://www.stackoverflow.com">www.stackoverflow.com</a>
</p>
